# Aggregation Functions

Pinot provides support for aggregations using GROUP BY. You can use the following functions to get the aggregated value.

| Function                                                                                                          | Description                                                                                                                                                                                                                                                                                                                      | Example                                                                                                                                                                                                                                                                                                                                                                                                                                           | Default Value When No Record Selected                                                    |
|-------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| ---------------------------------------------------------------------------------------- |
| [**COUNT**](../../configuration-reference/functions/count.md)                                                     | Get the count of rows in a group                                                                                                                                                                                                                                                                                                 | `COUNT(*)`                                                                                                                                                                                                                                                                                                                                                                                                                                        | `0`                                                                                      |
| [**MIN**](../../configuration-reference/functions/min.md)                                                         | Get the minimum value in a group                                                                                                                                                                                                                                                                                                 | `MIN(playerScore)`                                                                                                                                                                                                                                                                                                                                                                                                                                | `Double.POSITIVE_INFINITY`                                                               |
| [**MAX**](../../configuration-reference/functions/max.md)                                                         | Get the maximum value in a group                                                                                                                                                                                                                                                                                                 | `MAX(playerScore)`                                                                                                                                                                                                                                                                                                                                                                                                                                | `Double.NEGATIVE_INFINITY`                                                               |
| [**SUM**](../../configuration-reference/functions/sum.md)                                                         | Get the sum of values in a group                                                                                                                                                                                                                                                                                                 | `SUM(playerScore)`                                                                                                                                                                                                                                                                                                                                                                                                                                | `0`                                                                                      |
| [**SUMPRECISION**](../../configuration-reference/functions/sumprecision.md)                                       | Get the sum of values in a group with optional precision and optional scale                                                                                                                                                                                                                                                                                                 | `SUMPRECISION(salary), SUMPRECISION(salary, precision, scale)`                                                                                                                                                                                                                                                                                                                                                                                                                                | `0.0`                                                                                      |
| [**AVG**](../../configuration-reference/functions/avg.md)                                                         | Get the average of the values in a group                                                                                                                                                                                                                                                                                         | `AVG(playerScore)`                                                                                                                                                                                                                                                                                                                                                                                                                                | `Double.NEGATIVE_INFINITY`                                                               |
| [**MODE**](../../configuration-reference/functions/mode.md)                                                       | Get the most frequent value in a group. When multiple modes are present it gives the minimum of all the modes. This behavior can be overridden to get the maximum or the average mode.                                                                                                                                           | <p><code>MODE(playerScore)</code></p><p><code>MODE(playerScore, 'MIN')</code></p><p><code>MODE(playerScore, 'MAX')</code></p><p><code>MODE(playerScore, 'AVG')</code></p>                                                                                                                                                                                                                                                                         | `Double.NEGATIVE_INFINITY`                                                               |
| [**MINMAXRANGE**](../../configuration-reference/functions/minmaxrange.md)                                         | Returns the `max - min` value in a group                                                                                                                                                                                                                                                                                         | `MINMAXRANGE(playerScore)`                                                                                                                                                                                                                                                                                                                                                                                                                        | `Double.NEGATIVE_INFINITY`                                                               |
| [**PERCENTILE(column, N)**](../../configuration-reference/functions/percentile.md)                                | Returns the Nth percentile of the group where N is a decimal number between 0 and 100 inclusive                                                                                                                                                                                                                                  | `PERCENTILE(playerScore, 50), PERCENTILE(playerScore, 99.9)`                                                                                                                                                                                                                                                                                                                                                                                      | `Double.NEGATIVE_INFINITY`                                                               |
| [**PERCENTILEEST(column, N)**](../../configuration-reference/functions/percentileest.md)                          | Returns the Nth percentile of the group using [Quantile Digest](https://github.com/airlift/airlift/blob/master/stats/src/main/java/io/airlift/stats/QuantileDigest.java) algorithm                                                                                                                                               | `PERCENTILEEST(playerScore, 50), PERCENTILEEST(playerScore, 99.9)`                                                                                                                                                                                                                                                                                                                                                                                | `Long.MIN_VALUE`                                                                         |
| [**PERCENTILETDigest(column, N)**](../../configuration-reference/functions/percentiletdigest.md)                  | Returns the Nth percentile of the group using [T-digest algorithm](https://raw.githubusercontent.com/tdunning/t-digest/master/docs/t-digest-paper/histo.pdf)                                                                                                                                                                     | `PERCENTILETDIGEST(playerScore, 50), PERCENTILETDIGEST(playerScore, 99.9)`                                                                                                                                                                                                                                                                                                                                                                        | `Double.NaN`                                                                             |
| [**DISTINCTCOUNT**](../../configuration-reference/functions/distinctcount.md)                                     | Returns the count of distinct row values in a group                                                                                                                                                                                                                                                                              | `DISTINCTCOUNT(playerName)`                                                                                                                                                                                                                                                                                                                                                                                                                       | `0`                                                                                      |
| [**DISTINCTCOUNTBITMAP**](../../configuration-reference/functions/distinctcountbitmap.md)                         | Returns the count of distinct row values in a group. This function is accurate for _INT_ column, but approximate for other cases where hash codes are used in distinct counting and there may be hash collisions.                                                                                                                | `DISTINCTCOUNTBITMAP(playerName)`                                                                                                                                                                                                                                                                                                                                                                                                                 | `0`                                                                                      |
| [**DISTINCTCOUNTHLL**](../../configuration-reference/functions/distinctcounthll.md)                               | Returns an approximate distinct count using _HyperLogLog_. It also takes an optional second argument to configure the _log2m_ for the _HyperLogLog_.                                                                                                                                                                             | `DISTINCTCOUNTHLL(playerName, 12)`                                                                                                                                                                                                                                                                                                                                                                                                                | `0`                                                                                      |
| [**DISTINCTCOUNTRAWHLL**](../../configuration-reference/functions/distinctcountrawhll.md)                         | Returns HLL response serialized as string. The serialized HLL can be converted back into an HLL and then aggregated with other HLLs. A common use case may be to merge HLL responses from different Pinot tables, or to allow aggregation after client-side batching.                                                            | `DISTINCTCOUNTRAWHLL(playerName)`                                                                                                                                                                                                                                                                                                                                                                                                                 | `0`                                                                                      |
| [**DISTINCTCOUNTTHETASKETCH**](../../configuration-reference/functions/distinctcountthetasketch.md)               | See [Cardinality Estimation](how-to-handle-unique-counting.md)                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `0`                                                                                      |
| [**DISTINCTCOUNTRAWTHETASKETCH**](../../configuration-reference/functions/distinctcountrawthetasketch.md)         | See [Cardinality Estimation](how-to-handle-unique-counting.md)                                                                                                                                                                                                                                                                   |                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `0`                                                                                      |
| [**SEGMENTPARTITIONEDDISTINCTCOUNT**](../../configuration-reference/functions/segmentpartitioneddistinctcount.md) | Returns the count of distinct values of a column when the column is pre-partitioned for each segment, where there is no common value within different segments. This function calculates the exact count of distinct values within the segment, then simply sums up the results from different segments to get the final result. | `SEGMENTPARTITIONEDDISTINCTCOUNT(playerName)`                                                                                                                                                                                                                                                                                                                                                                                                     | `0`                                                                                      |
| **LASTWITHTIME(dataColumn, timeColumn, 'dataType')**                                                              | Get the last value of **dataColumn** where the **timeColumn** is used to define the time of dataColumn and the **dataType** specifies the type of dataColumn, which can be `BOOLEAN`, `INT`, `LONG`, `FLOAT`, `DOUBLE`, `STRING`                                                                                                 | <p><code>LASTWITHTIME(playerScore, timestampColumn, 'BOOLEAN')</code></p><p><code>LASTWITHTIME(playerScore, timestampColumn, 'INT')</code></p><p><code>LASTWITHTIME(playerScore, timestampColumn, 'LONG')</code></p><p><code>LASTWITHTIME(playerScore, timestampColumn, 'FLOAT')</code></p><p><code>LASTWITHTIME(playerScore, timestampColumn, 'DOUBLE')</code></p><p><code>LASTWITHTIME(playerScore, timestampColumn, 'STRING')</code></p>       | `INT: Int.MIN_VALUE LONG: Long.MIN_VALUE FLOAT: Float.NaN DOUBLE: Double.NaN STRING: ""` |
| **FIRSTWITHTIME(dataColumn, timeColumn, 'dataType')**                                                             | Get the first value of **dataColumn** where the **timeColumn** is used to define the time of dataColumn and the **dataType** specifies the type of dataColumn, which can be `BOOLEAN`, `INT`, `LONG`, `FLOAT`, `DOUBLE`, `STRING`                                                                                                | <p><code>FIRSTWITHTIME(playerScore, timestampColumn, 'BOOLEAN')</code></p><p><code>FIRSTWITHTIME(playerScore, timestampColumn, 'INT')</code></p><p><code>FIRSTWITHTIME(playerScore, timestampColumn, 'LONG')</code></p><p><code>FIRSTWITHTIME(playerScore, timestampColumn, 'FLOAT')</code></p><p><code>FIRSTWITHTIME(playerScore, timestampColumn, 'DOUBLE')</code></p><p><code>FIRSTWITHTIME(playerScore, timestampColumn, 'STRING')</code></p> | `INT: Int.MIN_VALUE LONG: Long.MIN_VALUE FLOAT: Float.NaN DOUBLE: Double.NaN STRING: ""` |

Deprecated functions:

| Function    | Description                                                                                                                                                            | Example               |
| ----------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------- | --------------------- |
| **FASTHLL** | FASTHLL stores serialized HyperLogLog in String format, which performs worse than DISTINCTCOUNTHLL, which supports serialized HyperLogLog in BYTES (byte array) format | `FASTHLL(playerName)` |

## Multi-value column functions

The following aggregation functions can be used for multi-value columns

| Function                                                                                                                                                                                                                                                                                                                                                                                              |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| <p><a href="../../configuration-reference/functions/countmv.md"><strong>COUNTMV</strong></a><br>Get the count of rows in a group</p>                                                                                                                                                                                                                                                                  |
| <p><a href="../../configuration-reference/functions/minmv.md"><strong>MINMV</strong></a><br>Get the minimum value in a group</p>                                                                                                                                                                                                                                                                      |
| <p><a href="../../configuration-reference/functions/maxmv.md"><strong>MAXMV</strong></a><br>Get the maximum value in a group</p>                                                                                                                                                                                                                                                                      |
| <p><a href="../../configuration-reference/functions/summv.md"><strong>SUMMV</strong></a><br>Get the sum of values in a group</p>                                                                                                                                                                                                                                                                      |
| <p><a href="../../configuration-reference/functions/avgmv.md"><strong>AVGMV</strong></a><br>Get the avg of values in a group</p>                                                                                                                                                                                                                                                                      |
| <p><a href="../../configuration-reference/functions/minmaxrangemv.md"><strong>MINMAXRANGEMV</strong></a><br>Returns the <code>max - min</code> value in a group</p>                                                                                                                                                                                                                                   |
| <p><a href="../../configuration-reference/functions/percentilemv.md"><strong>PERCENTILEMV(column, N)</strong></a><br>Returns the Nth percentile of the group where N is a decimal number between 0 and 100 inclusive</p>                                                                                                                                                                              |
| <p><a href="../../configuration-reference/functions/percentileestmv.md"><strong>PERCENTILEESTMV(column, N)</strong></a><br>Returns the Nth percentile of the group using <a href="https://github.com/airlift/airlift/blob/master/stats/src/main/java/io/airlift/stats/QuantileDigest.java">Quantile Digest</a></p>                                                                                    |
| <p><a href="../../configuration-reference/functions/percentiletdigestmv.md"><strong>PERCENTILETDIGESTMV(column, N)</strong></a><br>Returns the Nth percentile of the group using <a href="https://raw.githubusercontent.com/tdunning/t-digest/master/docs/t-digest-paper/histo.pdf">T-digest algorithm</a></p>                                                                                        |
| <p><a href="../../configuration-reference/functions/distinctcountmv.md"><strong>DISTINCTCOUNTMV</strong></a><br>Returns the count of distinct row values in a group</p>                                                                                                                                                                                                                               |
| <p><a href="../../configuration-reference/functions/distinctcountbitmapmv.md"><strong>DISTINCTCOUNTBITMAPMV</strong></a><br>Returns the count of distinct row values in a group. This function is accurate for INT or dictionary encoded column, but approximate for other cases where hash codes are used in distinct counting and there may be hash collision.</p>                                  |
| <p><a href="../../configuration-reference/functions/distinctcounthllmv.md"><strong>DISTINCTCOUNTHLLMV</strong></a><br>Returns an approximate distinct count using HyperLogLog in a group</p>                                                                                                                                                                                                          |
| <p><a href="../../configuration-reference/functions/distinctcountrawhllmv.md"><strong>DISTINCTCOUNTRAWHLLMV</strong></a><br>Returns HLL response serialized as string. The serialized HLL can be converted back into an HLL and then aggregated with other HLLs. A common use case may be to merge HLL responses from different Pinot tables, or to allow aggregation after client-side batching.</p> |

Deprecated functions:

| Function                   | Description                                                                                                                                                    | Example                  |
| -------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------ |
| **FASTHLLMV (Deprecated)** | stores serialized HyperLogLog in String format, which performs worse than DISTINCTCOUNTHLL, which supports serialized HyperLogLog in BYTES (byte array) format | `FASTHLLMV(playerNames)` |
